<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Join | ChatNinja</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/bootstrap.min.css" >
    <script src="/js/jquery.js"></script>
    <script src = "/socket.io/socket.io.js"></script>
  </head>
  <body style = "background-image: linear-gradient(to bottom right, hsla(0, 100%, 30%, 0.3), rgba(52,25,35,0.8));background-attachment: fixed; background-repeat: no-repeat;">
    <div class="container">
      <div class="row">
        <div style="display: flex;align-items: center;justify-content: center;height:80vh">
          <form id = "toChat" style = "background: rgba(0,0,0,0.8);padding:28px;border-radius: 5px; color:white;width:300px;box-shadow: 2px 3px 5px #000">
            <div class="text-center">
              <h3>
              <i class="fas fa-user-ninja"></i>
              Join ChatNinja</h3>
            </div>
            <div class="">
              <label> Display Name </label>
              <input type="text" class = "form-control" id = "ninja" placeholder="your ninja name" autofocus>
            </div>
            <div class="">
              <label> Room Name </label>
              <input type="text" class = "form-control" id = "room" placeholder="ninja room">
            </div>
            <div style = "align-self: flex-end; align-items: flex-end;padding:5px">
              <input type="submit" class = "btn btn-primary" value= "join" style = "float:right">
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>
<script>
  $(function () {
    $("#toChat").on('submit', function (e) {
      e.preventDefault();
      let crypt = cycleParam($('#ninja').val(), $('#room').val());
      window.location.href = `/chat.html?node=${crypt}`
    })
    function cycleParam (name, room) {
      return window.btoa(JSON.stringify({
        name: name,
        fleet: room
      }));
    }
  })
</script>